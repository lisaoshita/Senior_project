---
title: "Graphics for Final Report/Presentation"
author: "Lisa Oshita"
date: "4/6/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# table with percentages of country_destinations
xtable::xtable(df)
```

```{r}
# histogram of user's ages 
age_df <- train_users %>% select(country_destination, age_clean) %>% filter(age_clean > 0)
ggplot(data = age_df, aes(x = age_clean)) + 
  geom_histogram(bins = 20, alpha = 0.75) + 
  scale_x_continuous(limits = c(0, 100)) + 
  theme_minimal() + 
  xlab("Age") + ylab("Count") + ggtitle("Histogram of User's Ages")

ggsave(filename = "ages_histogram.pdf", plot = last_plot(), width = 8, height = 5)
```


```{r}
# bar chart of genders and country destinations 
genderdf <- train_users %>% select(country_destination, gender_clean) %>% filter(gender_clean != "unknown")

formatter <- function(x) {
  round(x / 117481, 2)
}

ggplot(data = genderdf, aes(x = forcats::fct_infreq(country_destination), fill = gender_clean)) + 
  geom_bar(position = "dodge") + 
  scale_fill_discrete(name = "Gender", labels = c("Female", "Male")) + 
  scale_y_continuous(labels = formatter) + 
  ylab("Proportion") + 
  xlab("Destination") + 
  ggtitle("Gender Preferences for Booking Destinations")

ggsave(filename = "gender_visual.pdf", plot = last_plot(), width = 8, height = 5)
```









